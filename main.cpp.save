#include "TXLib.h"

//Структура Кнопки
struct Button
{
    int x;
    int y;
    const char* text;
    string category;
};

struct Pictures
{
    int x;
    int y;
    int adress;
    HDC image;
    int w;
    int h;
    int w_scr;
    int h_scr;
    bool visible;
    string category;
};

//Функция рисования кнопки
void  drawButton(Button btn)
{

      txSetColor(TX_BLACK);
      txSetFillColor(TX_BLACK);
      Win32::RoundRect (txDC(),btn.x+3 ,btn.y+3 ,btn.x+153 ,btn.y+43, 30, 30);

      txSetColor(TX_BLACK);
      txSetFillColor(TX_WHITE);
      Win32::RoundRect (txDC(), btn.x, btn.y, btn.x+150, btn.y+40, 30, 30);

      txSetFillColor(TX_WHITE);
      txSetColor(TX_BLACK);
      txSelectFont("Times New Roman", 32);
      txDrawText(btn.x , btn.y,btn.x+150 ,btn.y+40, btn.text);
}

bool Click(Button btn)
{
return(txMouseX() >= btn.x &&
       txMouseY() >= btn.y &&
       txMouseX() <= btn.x + 150 &&
       txMouseY() <= btn.y + 40 &&
       txMouseButtons() == 1 );
}

void drawPicture(Pictures pct)
{
    if(pct.visible)
    {
        Win32::TransparentBlt(txDC(), pct.x, pct.y, pct.w_scr, pct.h_scr, pct.image, 0, 0,  pct.w, pct.h, TX_WHITE);
    }
}

int main()
{
txCreateWindow (1200, 800);

txDisableAutoPause();

txTextCursor (false);

    int COUNT_BTN = 10;
    int COUNT_PICTURE = 50;
    int select = -1;
    bool mouse_free = false;
    char str[100];

    //Массив кнопок
    Button btn[COUNT_BTN];
    btn[0] = {100, 50,"Овал лица", "Лицо"};
    btn[1] = {260, 50,"Стрижка", "Волосы"};
    btn[2] = {420, 50,"Разрез Глаз", "Глаза"};
    btn[3] = {580, 50,"Нос", "Нос"};
    btn[4] = {740, 50,"Губы", "Губы"};

    //Массив иконок-меню левых
    Pictures menuPictures[COUNT_PICTURE];
    menuPictures[0] = {50, 100,"Pictures/Нос/nose1.bmp", NULL, 100, 100, NULL, NULL, "Нос"};
    menuPictures[1] = {50, 200,"Pictures/Нос/nose2.bmp", NULL, 100, 100, NULL, NULL, "Нос"};
    menuPictures[2] = {50, 300,"Pictures/Нос/nose3.bmp", NULL, 100, 125, NULL, NULL, "Нос"};
    menuPictures[3] = {50, 400,"Pictures/Нос/nose4.bmp", NULL, 59, 100, NULL, NULL, "Нос"};
    menuPictures[4] = {50, 500,"Pictures/Нос/nose5.bmp", NULL 100, 116, NULL, NULL, "Нос"};
    menuPictures[5] = {50, 600,"Pictures/Нос/nose6.bmp", NULL, 62, 100, NULL, NULL, "Нос"};

    menuPictures[6]  = {50, 100,"Pictures/Лицо/face1M.bmp" txLoadImage (menuPictures[6].adress.c_str()), 94, 100, NULL, NULL, "Лицо"};
    menuPictures[7]  = {50, 200,"Pictures/Лицо/face1M.bmp" txLoadImage (menuPictures[7].adress.c_str()), 97, 100, NULL, NULL, "Лицо"};
    menuPictures[8]  = {50, 300,"Pictures/Лицо/face1M.bmp" txLoadImage (menuPictures[8].adress.c_str()), 70, 100, NULL, NULL, "Лицо"};
    menuPictures[9]  = {50, 400,"Pictures/Лицо/face1M.bmp" txLoadImage (menuPictures[9].adress.c_str()), 100, 136, NULL, NULL, "Лицо"};
    menuPictures[10] = {50, 500,"Pictures/Лицо/face1M.bmp" txLoadImage (menuPictures[10].adress.c_str()), 100, 115, NULL, NULL, "Лицо"};
    menuPictures[11] = {50, 600,"Pictures/Лицо/face1M.bmp" txLoadImage (menuPictures[11].adress.c_str()), 100, 131, NULL, NULL, "Лицо"};

    menuPictures[12] = {50, 100,"Pictures/Губы/lips1.bmp" txLoadImage (menuPictures[12].adress.c_str()), 100, 57, NULL, NULL, "Губы"};
    menuPictures[13] = {50, 200,"Pictures/Губы/lips1.bmp" txLoadImage (menuPictures[13].adress.c_str()), 100, 54, NULL, NULL, "Губы"};
    menuPictures[14] = {50, 300,"Pictures/Губы/lips1.bmp" txLoadImage (menuPictures[14].adress.c_str()), 100, 51, NULL, NULL, "Губы"};
    menuPictures[15] = {50, 400,"Pictures/Губы/lips1.bmp" txLoadImage (menuPictures[15].adress.c_str()), 100, 50, NULL, NULL, "Губы"};
    menuPictures[16] = {50, 500,"Pictures/Губы/lips1.bmp" txLoadImage (menuPictures[16].adress.c_str()), 100, 51, NULL, NULL, "Губы"};
    menuPictures[17] = {50, 600,"Pictures/Губы/lips1.bmp" txLoadImage (menuPictures[17].adress.c_str()), 100, 51, NULL, NULL, "Губы"};
    menuPictures[18] = {50, 700,"Pictures/Губы/lips1.bmp" txLoadImage (menuPictures[18].adress.c_str()), 100, 33, NULL, NULL, "Губы"};
    menuPictures[19] = {150, 100,"Pictures/Губы/lips1.bmp" txLoadImage (menuPictures[19].adress.c_str()), 100, 46, NULL, NULL, "Губы"};

    menuPictures[20] = {50, 100,"Pictures/Женский/Глаза/eyes1G.bmp" txLoadImage (menuPictures[20].adress.c_str()), 100, 35, NULL, NULL, "Глаза"};
    menuPictures[21] = {50, 200,"Pictures/Женский/Глаза/eyes1G.bmp" txLoadImage (menuPictures[21].adress.c_str()), 100, 39, NULL, NULL, "Глаза"};
    menuPictures[22] = {50, 300,"Pictures/Женский/Глаза/eyes1G.bmp" txLoadImage (menuPictures[22].adress.c_str()), 100, 37, NULL, NULL, "Глаза"};
    menuPictures[23] = {50, 400,"Pictures/Женский/Глаза/eyes1G.bmp" txLoadImage (menuPictures[23].adress.c_str()), 100, 27, NULL, NULL, "Глаза"};

    menuPictures[24] = {50, 500,"Pictures/Мужской/Глаза/eyes1M.bmp" txLoadImage (menuPictures[24].adress.c_str()), 100, 46, NULL, NULL, "Глаза"};
    menuPictures[25] = {50, 600,"Pictures/Мужской/Глаза/eyes1M.bmp" txLoadImage (menuPictures[25].adress.c_str()), 100, 38, NULL, NULL, "Глаза"};
    menuPictures[26] = {50, 700,"Pictures/Мужской/Глаза/eyes1M.bmp" txLoadImage (menuPictures[26].adress.c_str()), 100, 33, NULL, NULL, "Глаза"};
    menuPictures[27] = {150, 100,"Pictures/Мужской/Глаза/eyes1M.bmp" txLoadImage (menuPictures[27].adress.c_str()), 100, 32, NULL, NULL, "Глаза"};

    menuPictures[28] = {50, 100,"Pictures/Женский/Волосы/Hair1G.bmp" txLoadImage (menuPictures[28].adress.c_str()), 100, 108, NULL, NULL, "Волосы"};
    menuPictures[29] = {50, 200,"Pictures/Женский/Волосы/Hair1G.bmp" txLoadImage (menuPictures[29].adress.c_str()), 100, 102, NULL, NULL, "Волосы"};
    menuPictures[30] = {50, 300,"Pictures/Женский/Волосы/Hair1G.bmp" txLoadImage (menuPictures[30].adress.c_str()), 100, 105, NULL, NULL, "Волосы"};
    menuPictures[31] = {50, 400,"Pictures/Женский/Волосы/Hair1G.bmp" txLoadImage (menuPictures[31].adress.c_str()), 100, 123, NULL, NULL, "Волосы"};

    menuPictures[32] = {50, 500,"Pictures/Мужской/Волосы/Hair1M.bmp" txLoadImage (menuPictures[32].adress.c_str()), 100, 82,  NULL, NULL, "Волосы"};
    menuPictures[33] = {50, 600,"Pictures/Мужской/Волосы/Hair1M.bmp" txLoadImage (menuPictures[33].adress.c_str()), 100, 90,  NULL, NULL, "Волосы"};
    menuPictures[34] = {50, 700,"Pictures/Мужской/Волосы/Hair1M.bmp" txLoadImage (menuPictures[34].adress.c_str()), 100, 91,  NULL, NULL, "Волосы"};
    menuPictures[35] = {150, 100,"Pictures/Мужской/Волосы/Hair1M.bmp" txLoadImage (menuPictures[35].adress.c_str()), 100, 86,  NULL, NULL, "Волосы"};

    //Массив иконок центральных
    Pictures CentralPictures[COUNT_PICTURE];
    CentralPictures[0]   =  {600, 200};
    CentralPictures[1]   =  {600, 200};
    CentralPictures[2]   =  {600, 200};
    CentralPictures[3]   =  {600, 200};
    CentralPictures[4]   =  {600, 200};
    CentralPictures[5]   =  {600, 200};

    CentralPictures[6]   =  {600, 300};
    CentralPictures[7]   =  {600, 300};
    CentralPictures[8]   =  {600, 300};
    CentralPictures[9]   =  {600, 300};
    CentralPictures[10]  =  {600, 300};
    CentralPictures[11]  =  {600, 300};

    CentralPictures[12]  =  {600, 300};
    CentralPictures[13]  =  {600, 400};
    CentralPictures[14]  =  {600, 400};
    CentralPictures[15]  =  {600, 400};
    CentralPictures[16]  =  {600, 400};
    CentralPictures[17]  =  {600, 400};
    CentralPictures[18]  =  {600, 400};
    CentralPictures[19]  =  {600, 400};
    CentralPictures[20]  =  {600, 400};

    CentralPictures[21]  =  {600, 500};
    CentralPictures[22]  =  {600, 500};
    CentralPictures[23]  =  {600, 500};
    CentralPictures[24]  =  {600, 500};
    CentralPictures[25]  =  {600, 500};
    CentralPictures[26]  =  {600, 500};
    CentralPictures[27]  =  {600, 500};
    CentralPictures[28]  =  {600, 500};

    CentralPictures[29]  =  {600, 600};
    CentralPictures[30]  =  {600, 600};
    CentralPictures[31]  =  {600, 600};
    CentralPictures[32]  =  {600, 600};
    CentralPictures[33]  =  {600, 600};
    CentralPictures[34]  =  {600, 600};
    CentralPictures[35]  =  {600, 600};

 menuPictures[0].adress.c_str()

    for(int npic = 0; npic < COUNT_PICTURE; npic++)
    {
    
   if(menuPictures[npic].category == "Нос")
     menuPictures[npic].w_scr = 50;
     menuPictures[npic].h_scr = 50;

      if(menuPictures[npic].category == "Лицо")
      {
     menuPictures[npic].w_scr = 94;
     menuPictures[npic].h_scr = 100;
     }

      if(menuPictures[npic].category == "Губы")
      {
     menuPictures[npic].w_scr = 53;
     menuPictures[npic].h_scr = 100;
       }

      if(menuPictures[npic].category == "Глаза")
      {
     menuPictures[npic].w_scr = 100;
     menuPictures[npic].h_scr = 38;
      }

      if(menuPictures[npic].category == "Волосы")
      {
     menuPictures[npic].w_scr = 100;
     menuPictures[npic].h_scr = 100;
       }

    menuPictures[npic].visible = false;

    CentralPictures[npic].image = menuPictures[npic].image;
    menuPictures[npic].w =  menuPictures[npic].w;
    menuPictures[npic].h = menuPictures[npic].h;
    menuPictures[npic].w_scr = menuPictures[npic].w_scr;
    menuPictures[npic].h_scr = menuPictures[npic].h_scr;
    menuPictures[npic].visible = menuPictures[npic].visible;
    menuPictures[npic].category = menuPictures[npic].category;
    }

while(!GetAsyncKeyState(VK_ESCAPE))
{
    txBegin();
    txSetColor (TX_WHITE);
    txSetFillColor (TX_WHITE);
    txClear();


  //Левых картинок рисование
    for(int npic = 0; npic < COUNT_PICTURE; npic++)
    {
        drawPicture(menuPictures[npic]);
    }

    //Центральных картинок рисование
    for(int npic = 0; npic < COUNT_PICTURE; npic++)
    {
        drawPicture(CentralPictures[npic]);
    }

    //Центральных картинок рисование
    for(int npic = 0; npic < COUNT_PICTURE; npic++)
    {
        if(txMouseX() >= menuPictures[npic].x &&
        txMouseY() >= menuPictures[npic].y &&
        txMouseX() <= menuPictures[npic].x + menuPictures[npic].w_scr &&
        txMouseY() <= menuPictures[npic].y + menuPictures[npic].h_scr &&
        menuPictures[npic].visible &&
        txMouseButtons() == 1)
        {
            for(int n1 = 0; n1 < COUNT_PICTURE; n1++)
            {
                if(CentralPictures[n1].category == CentralPictures[npic].category)
                {
                    CentralPictures[n1].visible = false;
                }
            }
            CentralPictures[npic].visible = !CentralPictures[npic].visible;
            txSleep(100);
        }
    }

    //Рисование кнопок
    for(int nk=0; nk<5; nk++)
    {
        drawButton(btn[nk]);
    }

   //Видимость левых по категориям кнопок
    for(int nk=0; nk<COUNT_BTN; nk++)
    {
        if (Click(btn[nk]))
        {
            for(int npic = 0; npic < COUNT_PICTURE; npic++)
            {
                menuPictures[npic].visible = false;
                if (menuPictures[npic].category == btn[nk].category)
                {
                    menuPictures[npic].visible = true;
                }
            }
        }
    }

     //выбор центральной картинки
      for(int npic = 0; npic < COUNT_PICTURE; npic++)
    {
        if(txMouseX() >= CentralPictures[npic].x &&
        txMouseY() >= CentralPictures[npic].y &&
        txMouseX() <= CentralPictures[npic].x + CentralPictures[npic].w &&
        txMouseY() <= CentralPictures[npic].y + CentralPictures[npic].h &&
        CentralPictures[npic].visible &&
        txMouseButtons() == 1)
        {
           select = npic;
           mouse_free = false;


        }
    }

    //Передвижение центральной картинки выбранной клавишами
    if(select >= 0)
    {
        if(GetAsyncKeyState(VK_RIGHT)) CentralPictures[select].x += 3;
        if(GetAsyncKeyState(VK_LEFT)) CentralPictures[select].x -= 3;
        if(GetAsyncKeyState(VK_UP)) CentralPictures[select].y -= 3;
        if(GetAsyncKeyState(VK_DOWN)) CentralPictures[select].y += 3;

            if(GetAsyncKeyState(VK_OEM_PLUS))
            {
                CentralPictures[select].w_scr = CentralPictures[select].w_scr * 1.02;
                CentralPictures[select].h_scr = CentralPictures[select].h_scr * 1.02;
            }

            if(GetAsyncKeyState(VK_OEM_MINUS))
            {
                CentralPictures[select].w_scr = CentralPictures[select].w_scr * 0.98;
                CentralPictures[select].h_scr = CentralPictures[select].h_scr * 0.98;
            }

    }

        //Передвижение центральной картинки выбранной  мыщкой
    if(select >= 0)
    {
        if(txMouseButtons() == 1 && !mouse_free)
        {
            CentralPictures[select].x = txMouseX() - CentralPictures[select].w/2;
            CentralPictures[select].y = txMouseY() - CentralPictures[select].h/2;
        }
            else
            {
                if(txMouseButtons() != 1)
                {
                    mouse_free = true;
                }
            }
    }

    txSleep(50);
    txEnd();
}

    //Удаление левых
    for(int npic=0;npic <COUNT_PICTURE; npic++)
   {
        txDeleteDC(menuPictures[npic].image);
   }

    //Удаление центральных
    for(int npic=0;npic <COUNT_PICTURE; npic++)
   {
        txDeleteDC(CentralPictures[npic].image);
   }

return 0;
}
